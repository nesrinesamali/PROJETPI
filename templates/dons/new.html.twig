{% extends 'dashboard/front.html.twig' %}


{% block body %}
    <form id="my-form" method="post" enctype="multipart/form-data">
        <div class="col-lg-6" style="width: 120%;">
            <div class="card">
                <div class="card-body">
                    {{ form_start(form) }}
                    <div class="form-group">
                        {{ form_label(form.Cin) }}
                        {{ form_widget(form.Cin, {'attr': {'class': 'form-control cin-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.DateDon) }}
                        {{ form_widget(form.DateDon, {'attr': {'class': 'form-control date-don-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.datedernierdon) }}
                        {{ form_widget(form.datedernierdon, {'attr': {'class': 'form-control date-dernier-don-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.genre) }}
                        {{ form_widget(form.genre, {'attr': {'class': 'form-control genre-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.GroupeSanguin) }}
                        {{ form_widget(form.GroupeSanguin, {'attr': {'class': 'form-control groupe-sanguin-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.Etatmarital) }}
                        {{ form_widget(form.Etatmarital, {'attr': {'class': 'form-control etat-marital-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.typededon) }}
                        {{ form_widget(form.typededon, {'attr': {'class': 'form-control type-dedon-field'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.centreDon) }}
                        {{ form_widget(form.centreDon, {'attr': {'class': 'form-control centre-don-field'}}) }}
                    </div>
                    <div class="col-sm-7 mt-3">
                        <div class="d-flex justify-content-end">
                            <button type="submit" class="btn btn-outline-success mx-2" id="save-button"> <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>{{ 'ajouter'|trans }}</button>
                            <a href="{{ path('app_centre_don_index') }}" class="btn btn-outline-dark mx-2"> <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>Back</a>
                        </div>
                    </div>
                </div>
                {{ form_end(form) }}
            </div>
        </div>
    </form>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var cinField = document.querySelector('.cin-field');
        var dateDonField = document.querySelector('.date-don-field');
        var dateDernierDonField = document.querySelector('.date-dernier-don-field');
        var genreField = document.querySelector('.genre-field');
        var typeDeDonField = document.querySelector('.type-dedon-field');
        var groupeSanguinField = document.querySelector('.groupe-sanguin-field');
        var etatMaritalField = document.querySelector('.etat-marital-field');
        var centreDonField = document.querySelector('.centre-don-field');

        var nameRegex = /^[a-zA-Z]+$/;
        var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        var numberRegex = /^[0-9]+$/;

        function updateFieldValidity(field, isValid) {
            if (isValid) {
                field.style.borderColor = 'green';
                field.style.borderWidth = '2px';
            } else {
                field.style.borderColor = 'red';
                field.style.borderWidth = '2px';
            }
        }

        function validateField(field, regex) {
            var isValid = regex.test(field.value.trim());
            updateFieldValidity(field, isValid);
        }

        function validateNomCentreField() {
           // Sélectionnez le champ Cin
    var cinField = document.querySelector('.cin-field');

    // Récupérez la valeur du champ et supprimez les espaces vides avant et après
    var cinValue = cinField.value.trim();

    // Définissez une expression régulière pour vérifier si la valeur ne contient que des lettres
    var cinRegex = /^[a-zA-Z]+$/;

    // Vérifiez si la valeur du champ correspond à l'expression régulière
    var isValid = cinRegex.test(cinValue);

    // Mettez à jour la couleur de bordure en fonction de la validité du champ
    updateFieldValidity(cinField, isValid);
}
        function validateDateDonField() {
            // Ajoutez ici la validation pour la date de don
        }

        function validateDateDernierDonField() {
            // Ajoutez ici la validation pour la date du dernier don
        }

        function validateGenreField() {
            // Ajoutez ici la validation pour le genre
        }

        function validateGroupeSanguinField() {
            // Ajoutez ici la validation pour le groupe sanguin
        }

        function validateEtatMaritalField() {
            // Ajoutez ici la validation pour l'état marital
        }

        function validateTypeDeDonField() {
            // Ajoutez ici la validation pour le type de don
        }

        function validateCentreDonField() {
            // Ajoutez ici la validation pour le centre de don
        }

        cinField.addEventListener('input', validateNomCentreField);
        dateDonField.addEventListener('input', validateDateDonField);
        dateDernierDonField.addEventListener('input', validateDateDernierDonField);
        genreField.addEventListener('input', validateGenreField);
        groupeSanguinField.addEventListener('input', validateGroupeSanguinField);
        etatMaritalField.addEventListener('input', validateEtatMaritalField);
        typeDeDonField.addEventListener('input', validateTypeDeDonField);
        centreDonField.addEventListener('input', validateCentreDonField);
        typeDeDonField.addEventListener('change', function () {
            var selectedType = typeDeDonField.value;

            // Si le type de don est différent de "Sang", désactiver le champ groupe sanguin
            if (selectedType !== 'Sang') {
                groupeSanguinField.disabled = true;
            } else {
                groupeSanguinField.disabled = false;
            }
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.2/dist/sweetalert2.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.2/dist/sweetalert2.min.css">
    <script>
        document.getElementById('save-button').addEventListener('click', function(event) {
            event.preventDefault(); // Intercepter l'événement de soumission du formulaire
            Swal.fire({
                title: 'Voulez-vous vraiment confirmer l ajout?',
                text: 'Cette action ne pourra pas être annulée.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Oui',
                cancelButtonText: 'Non',
            }).then((result) => {
                if (result.isConfirmed) {
                    // Effectuer les modifications du fichier ici
                    // Par exemple, vous pouvez soumettre un formulaire en utilisant JavaScript
                    document.getElementById('my-form').submit();
        
                    Swal.fire(
                        'Ajouté!',
                        'Votre fichier a été ajouté.',
                        'success'
                    );
                } else {
                    Swal.fire(
                        'Annulé',
                        'L ajout n\'ont pas été enregistrées.',
                        'error'
                    );
                }
            });
        });
    </script>
{% endblock %}
